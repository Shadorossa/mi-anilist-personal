<div
    id="editor"
    class="hidden fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md"
>
    <div
        class="bg-[#0c0c0e] border border-white/10 w-full max-w-3xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-row relative h-[800px]"
    >
        <div class="w-[280px] bg-black relative shrink-0 overflow-hidden">
            <img
                id="editorCover"
                src=""
                class="absolute inset-0 w-full h-full object-cover opacity-80 mask-fade-right"
            />
            <div
                class="absolute inset-y-0 right-0 w-16 bg-gradient-to-l from-[#0c0c0e] to-transparent"
            >
            </div>
        </div>

        <div class="flex-1 p-6 flex flex-col relative min-w-0 bg-[#0c0c0e]">
            <button
                onclick="closeEditor()"
                class="absolute top-4 right-4 text-gray-500 hover:text-white transition"
                ><i class="fa-solid fa-xmark text-lg"></i></button
            >

            <div class="mb-5 pr-8">
                <h2
                    id="editorTitle"
                    class="text-xl font-black text-white leading-tight line-clamp-1"
                >
                </h2>
                <div class="flex items-center gap-2 mt-1">
                    <p
                        id="editorYear"
                        class="text-[10px] text-indigo-400 font-bold uppercase tracking-widest bg-indigo-500/10 px-2 py-0.5 rounded"
                    >
                    </p>
                    <button
                        id="favBtn"
                        onclick="toggleFav()"
                        class="text-gray-600 transition-all hover:scale-110 hover:text-red-400 text-sm"
                        ><i class="fa-solid fa-heart"></i></button
                    >
                </div>
            </div>

            <div class="flex-1 flex flex-col justify-start">
                <div class="flex justify-between items-center mb-4 px-2">
                    {
                        [
                            { v: "Jugando", i: "play", l: "Jugando" },
                            { v: "Pausado", i: "pause", l: "Pausa" },
                            { v: "Pendiente", i: "clock", l: "Pendiente" },
                            { v: "Abandonado", i: "ban", l: "Drop" },
                            { v: "Completado", i: "check", l: "Terminado" },
                        ].map((s) => (
                            <label class="cursor-pointer group flex flex-col items-center gap-1.5 w-12">
                                <input
                                    type="radio"
                                    name="status"
                                    value={s.v}
                                    class="status-radio hidden"
                                    onchange="checkScoreLock()"
                                />
                                <div class="w-9 h-9 rounded-full border border-white/10 flex items-center justify-center transition-all bg-[#18181b]">
                                    <i
                                        class={`fa-solid fa-${s.i} text-xs text-gray-500 status-icon transition-colors`}
                                    />
                                </div>
                                <span class="text-[8px] font-bold text-gray-600 uppercase status-text transition-colors opacity-60 group-hover:opacity-100">
                                    {s.l}
                                </span>
                            </label>
                        ))
                    }
                </div>

                <div class="mb-3">
                    <label class="form-label">Saga</label>
                    <select id="sagaSelector" class="form-input">
                        <option value="">Ninguna</option>
                        <!-- Options populated by script -->
                    </select>
                </div>

                <div class="mb-4">
                    <label class="form-label">Notas Privadas (Solo Admin)</label
                    >
                    <textarea
                        id="privateNotes"
                        class="form-input !h-24 resize-none"
                        placeholder="Cualquier cosa que quieras recordar..."
                    ></textarea>
                </div>

                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="date-input-wrapper">
                        <label class="date-input-label">Fecha Inicio</label>
                        <input type="date" id="startDate" class="date-input" />
                    </div>
                    <div class="date-input-wrapper">
                        <label class="date-input-label">Fecha Fin</label>
                        <input type="date" id="finishDate" class="date-input" />
                    </div>
                </div>

                <div
                    id="scoreContainer"
                    class="flex items-center justify-between bg-[#121215] border border-white/5 rounded-lg p-2 px-3 mb-4 transition-opacity"
                >
                    <span class="text-[9px] font-bold text-gray-500 uppercase"
                        >Valoración</span
                    >
                    <div class="flex items-center gap-3">
                        <div
                            class="stars-container flex gap-0.5 text-sm cursor-pointer"
                            id="starsVisual"
                        >
                        </div>
                        <span
                            id="scoreText"
                            class="text-white text-[10px] font-bold bg-white/10 px-2 py-0.5 rounded"
                            >0</span
                        >
                    </div>
                    <input
                        type="range"
                        id="scoreRange"
                        min="0"
                        max="10"
                        step="1"
                        value="0"
                        class="sr-only"
                    />
                </div>

                <div class="grid grid-cols-2 gap-4 mt-4">
                    <div
                        class="bg-[#121215] border border-white/5 rounded-lg p-3 mb-4"
                    >
                        <div class="flex justify-between items-center mb-3">
                            <span
                                class="text-[9px] font-bold text-gray-500 uppercase"
                                >Ajuste Cover (Historial)</span
                            >
                            <span
                                id="coverOffsetText"
                                class="text-white text-[10px] font-bold bg-white/10 px-2 py-0.5 rounded w-10 text-center"
                                >50%</span
                            >
                        </div>
                        <div class="flex items-center justify-center gap-3">
                            <!-- Preview Card -->
                            <div
                                class="bg-[#0a0a0c] border border-white/5 rounded-lg p-2 group cursor-default h-[100px] w-[160px] flex flex-col select-none"
                            >
                                <div class="flex gap-2 h-10 mb-2 shrink-0">
                                    <div
                                        class="w-10 bg-[#0a0a0c] rounded border border-white/5 flex flex-col items-center justify-center shrink-0"
                                    >
                                        <span
                                            class="text-[8px] text-gray-500 font-bold leading-none mb-0.5"
                                            >2024</span
                                        >
                                        <span
                                            class="text-[9px] text-indigo-400 font-black leading-none tracking-wide"
                                            >MES</span
                                        >
                                    </div>
                                    <div
                                        class="flex-1 relative rounded overflow-hidden shadow-sm"
                                    >
                                        <img
                                            id="editorPreviewCover"
                                            src=""
                                            class="absolute inset-0 w-full h-full object-cover"
                                            style="object-position: center 50%;"
                                        />
                                    </div>
                                </div>
                                <div
                                    class="flex-1 flex items-center justify-center px-0.5 min-h-[24px]"
                                >
                                    <h4
                                        id="editorPreviewTitle"
                                        class="text-[10px] font-bold text-gray-400 leading-tight text-center line-clamp-2"
                                    >
                                        Título de la obra
                                    </h4>
                                </div>
                            </div>
                            <!-- Vertical Slider -->
                            <div
                                id="custom-slider-container"
                                class="relative h-[100px] w-4 flex justify-center cursor-pointer"
                            >
                                <div
                                    class="w-1 h-full bg-white/10 rounded-full"
                                >
                                </div>
                                <div
                                    id="custom-slider-thumb"
                                    class="absolute w-4 h-4 bg-indigo-500 rounded-full cursor-grab"
                                    style="top: calc(50% - 8px);"
                                >
                                </div>
                            </div>
                            <!-- Hidden input to store the value -->
                            <input
                                type="hidden"
                                id="coverOffsetYRange"
                                value="50"
                            />
                        </div>
                    </div>

                    <div class="timeline-picker">
                        <div class="year-stepper-mini">
                            <span
                                class="text-[9px] font-black text-white/30 uppercase italic tracking-widest"
                                >Cronología</span
                            >
                            <div class="flex items-center gap-3">
                                <div
                                    class="year-nav-icon"
                                    onclick="changePickYear(-1)"
                                >
                                    <i class="fa-solid fa-chevron-left"></i>
                                </div>
                                <span class="year-value" id="pickYearDisplay"
                                    >2024</span
                                >
                                <div
                                    class="year-nav-icon"
                                    onclick="changePickYear(1)"
                                >
                                    <i class="fa-solid fa-chevron-right"></i>
                                </div>
                            </div>
                        </div>

                        <div class="month-grid-compact">
                            {
                                [
                                    "ENE",
                                    "FEB",
                                    "MAR",
                                    "ABR",
                                    "MAY",
                                    "JUN",
                                    "JUL",
                                    "AGO",
                                    "SEP",
                                    "OCT",
                                    "NOV",
                                    "DIC",
                                ].map((m, i) => (
                                    <button
                                        class="month-btn-item"
                                        onclick={`toggleMonthPick('${(i + 1).toString().padStart(2, "0")}')`}
                                        id={`month-btn-${(i + 1).toString().padStart(2, "0")}`}
                                    >
                                        {m}
                                    </button>
                                ))
                            }
                        </div>
                        <div
                            id="monthlyTagsContainer"
                            class="flex flex-wrap gap-1 mt-2"
                        >
                        </div>
                    </div>
                </div>
            </div>

            <div class="pt-4 mt-auto">
                <div class="flex items-center gap-4">
                    <button
                        id="deleteMediaBtn"
                        type="button"
                        class="bg-red-500/10 text-red-400 h-9 rounded-lg font-bold hover:bg-red-500/20 transition text-[10px] uppercase tracking-widest px-6"
                    >
                        Eliminar Logs
                    </button>
                    <button
                        id="saveMediaBtn"
                        type="button"
                        class="flex-1 bg-white text-black h-9 rounded-lg font-bold hover:bg-gray-200 transition shadow-lg active:scale-[0.98] text-[10px] uppercase tracking-widest"
                    >
                        Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
